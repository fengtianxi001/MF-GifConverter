import{F as b,r as C,c as M,_ as R}from"./common-wGBM91_D.js";import{V as p,c as k}from"./video-B9ONmHiO.js";import{i as v,x as B,q as f,s as _,d as y,o as I,a as w,b as l,t as h,e as D,k as g,u,y as V}from"./vendor-CnjT8O4b.js";import{_ as x}from"./index-DFn7Gc9O.js";function $(){const o=v([]),a=v([]);return{items:o,selected:a,onAddItem:async()=>{const s=await navigator.mediaDevices.getDisplayMedia({video:!0,audio:!1}),n=[],d=new MediaRecorder(s,{mimeType:"video/mp4"});d.ondataavailable=e=>{n.push(e.data)},d.start(100),d.onstop=async()=>{const e=new Blob(n),t=URL.createObjectURL(e),c=await p.getVideoObject(t);o.value.push({id:p.getId(),url:t,name:"录像"+new Date().getTime(),size:b.formatSize(e.size),type:"mp4",dpi:{width:c.videoWidth,height:c.videoHeight},file:e,duration:parseInt(c.duration*10+"")/10,lastModified:B().format("YYYY-MM-DD HH:mm:ss")}),f.success("录像导入成功")}},onRemoveItems:async s=>{const n=o.value.filter(({id:t})=>s.includes(t)).map(({name:t})=>t);if(!await C(n))return;const e=_(o.value,({id:t})=>s.includes(t));_(a.value,t=>s.includes(t)),f.success(`成功移除 ${e.length} 个视频`)},onConvertItems:async()=>{const s=o.value.filter(({id:n})=>a.value.includes(n));await M("video",s)}}}const z={class:"image-info"},U=["src"],S={class:"info-base"},Y={class:"info-name"},j={class:"info-size"},A=y({__name:"profile",props:{data:{}},setup(o){const a=o,r=()=>{k(a.data.url)};return(i,m)=>(I(),w("div",z,[l("video",{fit:"cover",src:i.data.url,width:50,height:34,onClick:r},null,8,U),l("div",S,[l("div",Y,h(i.data.name),1),l("div",j,h(i.data.size),1)])]))}}),H=x(A,[["__scopeId","data-v-5cb7ca1d"]]),P={class:"page"},F=y({__name:"index",setup(o){const{selected:a,items:r,onAddItem:i,onRemoveItems:m,onConvertItems:s}=$(),n=D(()=>[{text:"屏幕录制",type:"primary",onClick:()=>i()},{text:"批量删除",type:"primary",disabled:a.value.length<=0,onClick:()=>m(a.value)},{text:"转化选择项",type:"primary",disabled:a.value.length<=0,onClick:()=>s()}]),d=[{title:"基础信息",dataIndex:"name",width:400,render:({record:e})=>g(H,{data:e},null)},{title:"视频分辨率",dataIndex:"dpi",align:"center",render:({record:e})=>`${e.dpi.width} * ${e.dpi.height}`},{title:"视频时长(秒)",dataIndex:"duration",align:"center"},{title:"视频类型",dataIndex:"type",align:"center"},{title:"最后编辑时间",dataIndex:"lastModified",align:"center"}];return(e,t)=>(I(),w("div",P,[g(u(R),{selected:u(a),"onUpdate:selected":t[0]||(t[0]=c=>V(a)?a.value=c:null),options:{rowSelection:{type:"radio"}},data:u(r),operates:n.value,columns:d},null,8,["selected","data","operates"])]))}}),q=x(F,[["__scopeId","data-v-afe605f7"]]);export{q as default};
