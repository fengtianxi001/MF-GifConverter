import{g as Pe}from"./dayjs-BZIFujmo.js";var Fe={exports:{}};(function(ke,je){(function(L,N,ee,T){var n={URL:L.URL||L.webkitURL||L.mozURL||L.msURL,getUserMedia:function(){var r=ee.getUserMedia||ee.webkitGetUserMedia||ee.mozGetUserMedia||ee.msGetUserMedia;return r&&r.bind(ee)}(),requestAnimFrame:L.requestAnimationFrame||L.webkitRequestAnimationFrame||L.mozRequestAnimationFrame||L.oRequestAnimationFrame||L.msRequestAnimationFrame,requestTimeout:function(e,a){if(e=e||n.noop,a=a||0,!n.requestAnimFrame)return setTimeout(e,a);var i=new Date().getTime(),t=new Object,l=n.requestAnimFrame,s=function o(){var v=new Date().getTime(),c=v-i;c>=a?e.call():t.value=l(o)};return t.value=l(s),t},Blob:L.Blob||L.BlobBuilder||L.WebKitBlobBuilder||L.MozBlobBuilder||L.MSBlobBuilder,btoa:function(){var r=L.btoa||function(e){for(var a="",i=0,t=e.length,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s=void 0,o=void 0,v=void 0,c=void 0,b=void 0,S=void 0,p=void 0;i<t;)s=e.charCodeAt(i++),o=e.charCodeAt(i++),v=e.charCodeAt(i++),c=s>>2,b=(s&3)<<4|o>>4,S=(o&15)<<2|v>>6,p=v&63,isNaN(o)?S=p=64:isNaN(v)&&(p=64),a=a+l.charAt(c)+l.charAt(b)+l.charAt(S)+l.charAt(p);return a};return r?r.bind(L):n.noop}(),isObject:function(e){return e&&Object.prototype.toString.call(e)==="[object Object]"},isEmptyObject:function(e){return n.isObject(e)&&!Object.keys(e).length},isArray:function(e){return e&&Array.isArray(e)},isFunction:function(e){return e&&typeof e=="function"},isElement:function(e){return e&&e.nodeType===1},isString:function(e){return typeof e=="string"||Object.prototype.toString.call(e)==="[object String]"},isSupported:{canvas:function(){var e=N.createElement("canvas");return e&&e.getContext&&e.getContext("2d")},webworkers:function(){return L.Worker},blob:function(){return n.Blob},Uint8Array:function(){return L.Uint8Array},Uint32Array:function(){return L.Uint32Array},videoCodecs:function(){var r=N.createElement("video"),e={mp4:!1,h264:!1,ogv:!1,ogg:!1,webm:!1};try{r&&r.canPlayType&&(e.mp4=r.canPlayType('video/mp4; codecs="mp4v.20.8"')!=="",e.h264=(r.canPlayType('video/mp4; codecs="avc1.42E01E"')||r.canPlayType('video/mp4; codecs="avc1.42E01E, mp4a.40.2"'))!=="",e.ogv=r.canPlayType('video/ogg; codecs="theora"')!=="",e.ogg=r.canPlayType('video/ogg; codecs="theora"')!=="",e.webm=r.canPlayType('video/webm; codecs="vp8, vorbis"')!==-1)}catch{}return e}()},noop:function(){},each:function(e,a){var i=void 0,t=void 0;if(n.isArray(e))for(i=-1,t=e.length;++i<t&&a(i,e[i])!==!1;);else if(n.isObject(e)){for(i in e)if(e.hasOwnProperty(i)&&a(i,e[i])===!1)break}},mergeOptions:function(e,a){if(!(!n.isObject(e)||!n.isObject(a)||!Object.keys)){var i={};return n.each(e,function(t,l){i[t]=e[t]}),n.each(a,function(t,l){var s=a[t];n.isObject(s)&&e[t]?i[t]=n.mergeOptions(e[t],s):i[t]=s}),i}},setCSSAttr:function(e,a,i){n.isElement(e)&&(n.isString(a)&&n.isString(i)?e.style[a]=i:n.isObject(a)&&n.each(a,function(t,l){e.style[t]=l}))},removeElement:function(e){n.isElement(e)&&e.parentNode&&e.parentNode.removeChild(e)},createWebWorker:function(e){if(!n.isString(e))return{};try{var a=new n.Blob([e],{type:"text/javascript"}),i=n.URL.createObjectURL(a),t=new Worker(i);return{objectUrl:i,worker:t}}catch(l){return""+l}},getExtension:function(e){return e.substr(e.lastIndexOf(".")+1,e.length)},getFontSize:function(){var e=arguments.length>0&&arguments[0]!==T?arguments[0]:{};if(!N.body||e.resizeFont===!1)return e.fontSize;var a=e.text,i=e.gifWidth,t=parseInt(e.fontSize,10),l=parseInt(e.minFontSize,10),s=N.createElement("div"),o=N.createElement("span");for(s.setAttribute("width",i),s.appendChild(o),o.innerHTML=a,o.style.fontSize=t+"px",o.style.textIndent="-9999px",o.style.visibility="hidden",N.body.appendChild(o);o.offsetWidth>i&&t>=l;)o.style.fontSize=--t+"px";return N.body.removeChild(o),t+"px"},webWorkerError:!1},We=Object.freeze({default:n}),X={validate:function(e){e=n.isObject(e)?e:{};var a={};return n.each(X.validators,function(i,t){var l=t.errorCode;if(!e[l]&&!t.condition)return a=t,a.error=!0,!1}),delete a.condition,a},isValid:function(e){var a=X.validate(e),i=a.error!==!0;return i},validators:[{condition:n.isFunction(n.getUserMedia),errorCode:"getUserMedia",errorMsg:"The getUserMedia API is not supported in your browser"},{condition:n.isSupported.canvas(),errorCode:"canvas",errorMsg:"Canvas elements are not supported in your browser"},{condition:n.isSupported.webworkers(),errorCode:"webworkers",errorMsg:"The Web Workers API is not supported in your browser"},{condition:n.isFunction(n.URL),errorCode:"window.URL",errorMsg:"The window.URL API is not supported in your browser"},{condition:n.isSupported.blob(),errorCode:"window.Blob",errorMsg:"The window.Blob File API is not supported in your browser"},{condition:n.isSupported.Uint8Array(),errorCode:"window.Uint8Array",errorMsg:"The window.Uint8Array function constructor is not supported in your browser"},{condition:n.isSupported.Uint32Array(),errorCode:"window.Uint32Array",errorMsg:"The window.Uint32Array function constructor is not supported in your browser"}],messages:{videoCodecs:{errorCode:"videocodec",errorMsg:"The video codec you are trying to use is not supported in your browser"}}},Ee=Object.freeze({default:X}),ue=function(){},de={sampleInterval:10,numWorkers:2,filter:"",gifWidth:200,gifHeight:200,interval:.1,numFrames:10,frameDuration:1,keepCameraOn:!1,images:[],video:null,webcamVideoElement:null,cameraStream:null,text:"",fontWeight:"normal",fontSize:"16px",minFontSize:"10px",resizeFont:!1,fontFamily:"sans-serif",fontColor:"#ffffff",textAlign:"center",textBaseline:"bottom",textXCoordinate:null,textYCoordinate:null,progressCallback:ue,completeCallback:ue,saveRenderingContexts:!1,savedRenderingContexts:[],crossOrigin:"Anonymous"},Ae=Object.freeze({default:de});function Te(){return X.isValid()}function he(){return X.isValid()}function Ie(){var r={getUserMedia:!0};return X.isValid(r)}function Ue(r){var e=!1;if(n.isArray(r)&&r.length){if(n.each(r,function(a,i){n.isSupported.videoCodecs[i]&&(e=!0)}),!e)return!1}else if(n.isString(r)&&r.length&&!n.isSupported.videoCodecs[r])return!1;return X.isValid({getUserMedia:!0})}function pe(){var r=256,e=499,a=491,i=487,t=503,l=3*t,s=r-1,o=4,v=100,c=16,b=1<<c,S=10,p=10,f=b>>p,y=b<<S-p,w=r>>3,C=6,k=1<<C,G=w*k,U=30,O=10,M=1<<O,H,j=8,B=1<<j,P=O+j,R=1<<P,K,z,_,W,Y=[],J=[],Z=[],re=[];function fe(g,u,A){var h,x;for(K=g,z=u,_=A,W=new Array(r),h=0;h<r;h++)W[h]=new Array(4),x=W[h],x[0]=x[1]=x[2]=(h<<o+8)/r|0,Z[h]=b/r|0,J[h]=0}function te(){for(var g=[],u=new Array(r),A=0;A<r;A++)u[W[A][3]]=A;for(var h=0,x=0;x<r;x++){var d=u[x];g[h++]=W[d][0],g[h++]=W[d][1],g[h++]=W[d][2]}return g}function ae(){var g,u,A,h,x,d,m,F;for(m=0,F=0,g=0;g<r;g++){for(x=W[g],A=g,h=x[1],u=g+1;u<r;u++)d=W[u],d[1]<h&&(A=u,h=d[1]);if(d=W[A],g!=A&&(u=d[0],d[0]=x[0],x[0]=u,u=d[1],d[1]=x[1],x[1]=u,u=d[2],d[2]=x[2],x[2]=u,u=d[3],d[3]=x[3],x[3]=u),h!=m){for(Y[m]=F+g>>1,u=m+1;u<h;u++)Y[u]=g;m=h,F=g}}for(Y[m]=F+s>>1,u=m+1;u<256;u++)Y[u]=s}function ie(){var g,u,A,h,x,d,m,F,E,V,Q,I,q,we;for(z<l&&(_=1),H=30+(_-1)/3,I=K,q=0,we=z,Q=z/(3*_),V=Q/v|0,F=M,d=G,m=d>>C,m<=1&&(m=0),g=0;g<m;g++)re[g]=F*((m*m-g*g)*B/(m*m));for(z<l?E=3:z%e!==0?E=3*e:z%a!==0?E=3*a:z%i!==0?E=3*i:E=3*t,g=0;g<Q;)if(A=(I[q+0]&255)<<o,h=(I[q+1]&255)<<o,x=(I[q+2]&255)<<o,u=ve(A,h,x),le(F,u,A,h,x),m!==0&&se(m,u,A,h,x),q+=E,q>=we&&(q-=z),g++,V===0&&(V=1),g%V===0)for(F-=F/H,d-=d/U,m=d>>C,m<=1&&(m=0),u=0;u<m;u++)re[u]=F*((m*m-u*u)*B/(m*m))}function ne(g,u,A){var h,x,d,m,F,E,V;for(F=1e3,V=-1,h=Y[u],x=h-1;h<r||x>=0;)h<r&&(E=W[h],d=E[1]-u,d>=F?h=r:(h++,d<0&&(d=-d),m=E[0]-g,m<0&&(m=-m),d+=m,d<F&&(m=E[2]-A,m<0&&(m=-m),d+=m,d<F&&(F=d,V=E[3])))),x>=0&&(E=W[x],d=u-E[1],d>=F?x=-1:(x--,d<0&&(d=-d),m=E[0]-g,m<0&&(m=-m),d+=m,d<F&&(m=E[2]-A,m<0&&(m=-m),d+=m,d<F&&(F=d,V=E[3]))));return V}function ge(){return ie(),oe(),ae(),te()}function oe(){var g;for(g=0;g<r;g++)W[g][0]>>=o,W[g][1]>>=o,W[g][2]>>=o,W[g][3]=g}function se(g,u,A,h,x){var d,m,F,E,V,Q,I;for(F=u-g,F<-1&&(F=-1),E=u+g,E>r&&(E=r),d=u+1,m=u-1,Q=1;d<E||m>F;){if(V=re[Q++],d<E){I=W[d++];try{I[0]-=V*(I[0]-A)/R|0,I[1]-=V*(I[1]-h)/R|0,I[2]-=V*(I[2]-x)/R|0}catch{}}if(m>F){I=W[m--];try{I[0]-=V*(I[0]-A)/R|0,I[1]-=V*(I[1]-h)/R|0,I[2]-=V*(I[2]-x)/R|0}catch{}}}}function le(g,u,A,h,x){var d=W[u],m=g/M;d[0]-=m*(d[0]-A)|0,d[1]-=m*(d[1]-h)|0,d[2]-=m*(d[2]-x)|0}function ve(g,u,A){var h,x,d,m,F,E,V,Q,I,q;for(Q=~(1<<31),I=Q,E=-1,V=E,h=0;h<r;h++)q=W[h],x=q[0]-g,x<0&&(x=-x),d=q[1]-u,d<0&&(d=-d),x+=d,d=q[2]-A,d<0&&(d=-d),x+=d,x<Q&&(Q=x,E=h),m=x-(J[h]>>c-o),m<I&&(I=m,V=h),F=Z[h]>>p,Z[h]-=F,J[h]+=F<<S;return Z[E]+=f,J[E]-=y,V}fe.apply(this,arguments);var $={};return $.map=ne,$.process=ge,$}function xe(){var r=this;try{r.onmessage=function(a){var i=a.data||{},t;i.gifshot&&(t=e.run(i),postMessage(t))}}catch{}var e={dataToRGB:function(i,t,l){for(var s=t*l*4,o=0,v=[];o<s;)v.push(i[o++]),v.push(i[o++]),v.push(i[o++]),o++;return v},componentizedPaletteToArray:function(i){i=i||[];for(var t=[],l=0;l<i.length;l+=3){var s=i[l],o=i[l+1],v=i[l+2];t.push(s<<16|o<<8|v)}return t},processFrameWithQuantizer:function(i,t,l,s){for(var o=this.dataToRGB(i,t,l),v=new pe(o,o.length,s),c=v.process(),b=new Uint32Array(this.componentizedPaletteToArray(c)),S=t*l,p=new Uint8Array(S),f=0,y=0;y<S;y++){var w=o[f++],C=o[f++],k=o[f++];p[y]=v.map(w,C,k)}return{pixels:p,palette:b}},run:function(i){i=i||{};var t=i,l=t.height;t.palette;var s=t.sampleInterval,o=t.width,v=i.data;return this.processFrameWithQuantizer(v,o,l,s)}};return e}function Oe(r,e,a,i){var t=0;i=i===T?{}:i;var l=i.loop===T?null:i.loop,s=i.palette===T?null:i.palette;if(e<=0||a<=0||e>65535||a>65535)throw"Width/Height invalid.";function o(p){var f=p.length;if(f<2||f>256||f&f-1)throw"Invalid code/color length, must be power of 2 and 2 .. 256.";return f}r[t++]=71,r[t++]=73,r[t++]=70,r[t++]=56,r[t++]=57,r[t++]=97;var v=0,c=0;if(r[t++]=e&255,r[t++]=e>>8&255,r[t++]=a&255,r[t++]=a>>8&255,r[t++]=(s!==null?128:0)|v,r[t++]=c,r[t++]=0,l!==null){if(l<0||l>65535)throw"Loop count invalid.";r[t++]=33,r[t++]=255,r[t++]=11,r[t++]=78,r[t++]=69,r[t++]=84,r[t++]=83,r[t++]=67,r[t++]=65,r[t++]=80,r[t++]=69,r[t++]=50,r[t++]=46,r[t++]=48,r[t++]=3,r[t++]=1,r[t++]=l&255,r[t++]=l>>8&255,r[t++]=0}var b=!1;this.addFrame=function(p,f,y,w,C,k){if(b===!0&&(--t,b=!1),k=k===T?{}:k,p<0||f<0||p>65535||f>65535)throw"x/y invalid.";if(y<=0||w<=0||y>65535||w>65535)throw"Width/Height invalid.";if(C.length<y*w)throw"Not enough pixels for the frame size.";var G=!0,U=k.palette;if((U===T||U===null)&&(G=!1,U=s),U===T||U===null)throw"Must supply either a local or global palette.";for(var O=o(U),M=0;O>>=1;)++M;O=1<<M;var H=k.delay===T?0:k.delay,j=k.disposal===T?0:k.disposal;if(j<0||j>3)throw"Disposal out of range.";var B=!1,P=0;if(k.transparent!==T&&k.transparent!==null&&(B=!0,P=k.transparent,P<0||P>=O))throw"Transparent color index.";if((j!==0||B||H!==0)&&(r[t++]=33,r[t++]=249,r[t++]=4,r[t++]=j<<2|(B===!0?1:0),r[t++]=H&255,r[t++]=H>>8&255,r[t++]=P,r[t++]=0),r[t++]=44,r[t++]=p&255,r[t++]=p>>8&255,r[t++]=f&255,r[t++]=f>>8&255,r[t++]=y&255,r[t++]=y>>8&255,r[t++]=w&255,r[t++]=w>>8&255,r[t++]=G===!0?128|M-1:0,G===!0)for(var R=0,K=U.length;R<K;++R){var z=U[R];r[t++]=z>>16&255,r[t++]=z>>8&255,r[t++]=z&255}t=S(r,t,M<2?2:M,C)},this.end=function(){return b===!1&&(r[t++]=59,b=!0),t};function S(p,f,y,w){p[f++]=y;var C=f++,k=1<<y,G=k-1,U=k+1,O=U+1,M=y+1,H=0,j=0;function B(Z){for(;H>=Z;)p[f++]=j&255,j>>=8,H-=8,f===C+256&&(p[C]=255,C=f++)}function P(Z){j|=Z<<H,H+=M,B(8)}var R=w[0]&G,K={};P(k);for(var z=1,_=w.length;z<_;++z){var W=w[z]&G,Y=R<<8|W,J=K[Y];if(J===T){for(j|=R<<H,H+=M;H>=8;)p[f++]=j&255,j>>=8,H-=8,f===C+256&&(p[C]=255,C=f++);O===4096?(P(k),O=U+1,M=y+1,K={}):(O>=1<<M&&++M,K[Y]=O++),R=W}else R=J}return P(R),P(U),B(1),C+1===f?p[C]=0:(p[C]=f-C-1,p[f++]=0),f}}var be=function(){},ce=function(e){this.canvas=null,this.ctx=null,this.repeat=0,this.frames=[],this.numRenderedFrames=0,this.onRenderCompleteCallback=be,this.onRenderProgressCallback=be,this.workers=[],this.availableWorkers=[],this.generatingGIF=!1,this.options=e,this.initializeWebWorkers(e)};ce.prototype={workerMethods:xe(),initializeWebWorkers:function(e){var a=this,i=pe.toString()+"("+xe.toString()+"());",t=void 0,l=void 0,s=void 0,o=void 0,v=-1,c="";for(o=e.numWorkers;++v<o;)t=n.createWebWorker(i),n.isObject(t)?(l=t.objectUrl,s=t.worker,a.workers.push({worker:s,objectUrl:l}),a.availableWorkers.push(s)):(c=t,n.webWorkerError=!!t);this.workerError=c,this.canvas=N.createElement("canvas"),this.canvas.width=e.gifWidth,this.canvas.height=e.gifHeight,this.ctx=this.canvas.getContext("2d"),this.frames=[]},getWorker:function(){return this.availableWorkers.pop()},freeWorker:function(e){this.availableWorkers.push(e)},byteMap:function(){for(var r=[],e=0;e<256;e++)r[e]=String.fromCharCode(e);return r}(),bufferToString:function(e){for(var a=e.length,i="",t=-1;++t<a;)i+=this.byteMap[e[t]];return i},onFrameFinished:function(e){var a=this,i=a.frames,t=a.options,l=!!(t.images||[]).length,s=i.every(function(o){return!o.beingProcessed&&o.done});a.numRenderedFrames++,l&&e(a.numRenderedFrames/i.length),a.onRenderProgressCallback(a.numRenderedFrames*.75/i.length),s?a.generatingGIF||a.generateGIF(i,a.onRenderCompleteCallback):n.requestTimeout(function(){a.processNextFrame()},1)},processFrame:function(e){var a=this;this.options;var i=this.options,t=i.progressCallback,l=i.sampleInterval,s=this.frames,o=void 0,v=void 0,c=function(){var S=arguments.length>0&&arguments[0]!==T?arguments[0]:{},p=S.data;delete o.data,o.pixels=Array.prototype.slice.call(p.pixels),o.palette=Array.prototype.slice.call(p.palette),o.done=!0,o.beingProcessed=!1,a.freeWorker(v),a.onFrameFinished(t)};if(o=s[e],o.beingProcessed||o.done){this.onFrameFinished();return}o.sampleInterval=l,o.beingProcessed=!0,o.gifshot=!0,v=this.getWorker(),v?(v.onmessage=c,v.postMessage(o)):c({data:a.workerMethods.run(o)})},startRendering:function(e){this.onRenderCompleteCallback=e;for(var a=0;a<this.options.numWorkers&&a<this.frames.length;a++)this.processFrame(a)},processNextFrame:function(){for(var e=-1,a=0;a<this.frames.length;a++){var i=this.frames[a];if(!i.done&&!i.beingProcessed){e=a;break}}e>=0&&this.processFrame(e)},generateGIF:function(e,a){var i=[],t={loop:this.repeat},l=this.options,s=l.interval,o=l.frameDuration,v=l.images,c=!!v.length,b=l.gifHeight,S=l.gifWidth,p=new Oe(i,S,b,t),f=this.onRenderProgressCallback,y=c?s*100:0,w=void 0,C=void 0;this.generatingGIF=!0,n.each(e,function(k,G){var U=G.palette;f(.75+.25*G.position*1/e.length);for(var O=0;O<o;O++)p.addFrame(0,0,S,b,G.pixels,{palette:U,delay:y})}),p.end(),f(1),this.frames=[],this.generatingGIF=!1,n.isFunction(a)&&(w=this.bufferToString(i),C="data:image/gif;base64,"+n.btoa(w),a(C))},setRepeat:function(e){this.repeat=e},addFrame:function(e,a){a=n.isObject(a)?a:{};var i=this,t=i.ctx,l=i.options,s=l.gifWidth,o=l.gifHeight,v=n.getFontSize(a),c=a,b=c.filter,S=c.fontColor,p=c.fontFamily,f=c.fontWeight;c.gifHeight,c.gifWidth;var y=c.text,w=c.textAlign,C=c.textBaseline,k=a.textXCoordinate?a.textXCoordinate:w==="left"?1:w==="right"?s:s/2,G=a.textYCoordinate?a.textYCoordinate:C==="top"?1:C==="center"?o/2:o,U=f+" "+v+" "+p,O=void 0;try{t.filter=b,t.drawImage(e,0,0,s,o),y&&(t.font=U,t.fillStyle=S,t.textAlign=w,t.textBaseline=C,t.fillText(y,k,G)),O=t.getImageData(0,0,s,o),i.addFrameImageData(O)}catch(M){return""+M}},addFrameImageData:function(){var e=arguments.length>0&&arguments[0]!==T?arguments[0]:{},a=this.frames,i=e.data;this.frames.push({data:i,width:e.width,height:e.height,palette:null,dithering:null,done:!1,beingProcessed:!1,position:a.length})},onRenderProgress:function(e){this.onRenderProgressCallback=e},isRendering:function(){return this.generatingGIF},getBase64GIF:function(e){var a=this,i=function(l){a.destroyWorkers(),n.requestTimeout(function(){e(l)},0)};a.startRendering(i)},destroyWorkers:function(){if(!this.workerError){var e=this.workers;n.each(e,function(a,i){var t=i.worker,l=i.objectUrl;t.terminate(),n.URL.revokeObjectURL(l)})}}};function Re(r,e){r.getBase64GIF(function(a){e({error:!1,errorCode:"",errorMsg:"",image:a})})}function Ve(){var r=arguments.length>0&&arguments[0]!==T?arguments[0]:{},e=r.callback,a=r.images,i=r.options,t=r.imagesLength,l={getUserMedia:!0,"window.URL":!0},s=X.validate(l),o=[],v=0,c=void 0,b=void 0;if(s.error)return e(s);b=new ce(i),n.each(a,function(p,f){var y=f;f.src&&(y=y.src),n.isElement(y)?(i.crossOrigin&&(y.crossOrigin=i.crossOrigin),o[p]=y,v+=1,v===t&&S()):n.isString(y)&&(c=new Image,i.crossOrigin&&(c.crossOrigin=i.crossOrigin),function(w){f.text&&(w.text=f.text),w.onerror=function(C){var k=void 0;if(--t,t===0)return k={},k.error="None of the requested images was capable of being retrieved",e(k)},w.onload=function(C){f.text?o[p]={img:w,text:w.text}:o[p]=w,v+=1,v===t&&S(),n.removeElement(w)},w.src=y}(c),n.setCSSAttr(c,{position:"fixed",opacity:"0"}),N.body.appendChild(c))});function S(){n.each(o,function(p,f){f&&(f.text?b.addFrame(f.img,i,f.text):b.addFrame(f,i))}),Re(b,e)}}var Me=function(){},me={getGIF:function(){var e=arguments.length>0&&arguments[0]!==T?arguments[0]:{},a=arguments[1];a=n.isFunction(a)?a:Me;var i=N.createElement("canvas"),t=void 0,l=e.images,s=!!l.length,o=e.cameraStream,v=e.crop,c=e.filter,b=e.fontColor,S=e.fontFamily,p=e.fontWeight,f=e.keepCameraOn;e.numWorkers;var y=e.progressCallback,w=e.saveRenderingContexts,C=e.savedRenderingContexts,k=e.text,G=e.textAlign,U=e.textBaseline,O=e.videoElement,M=e.videoHeight,H=e.videoWidth,j=e.webcamVideoElement,B=Number(e.gifWidth),P=Number(e.gifHeight),R=Number(e.interval);Number(e.sampleInterval);var K=s?0:R*1e3,z=[],_=C.length?C.length:e.numFrames,W=_,Y=new ce(e),J=n.getFontSize(e),Z=e.textXCoordinate?e.textXCoordinate:G==="left"?1:G==="right"?B:B/2,re=e.textYCoordinate?e.textYCoordinate:U==="top"?1:U==="center"?P/2:P,fe=p+" "+J+" "+S,te=v?Math.floor(v.scaledWidth/2):0,ae=v?H-v.scaledWidth:0,ie=v?Math.floor(v.scaledHeight/2):0,ne=v?M-v.scaledHeight:0,ge=function oe(){var se=W-1;C.length?(t.putImageData(C[_-W],0,0),ve()):le();function le(){try{ae>H&&(ae=H),ne>M&&(ne=M),te<0&&(te=0),ie<0&&(ie=0),t.filter=c,t.drawImage(O,te,ie,ae,ne,0,0,B,P),ve()}catch($){if($.name==="NS_ERROR_NOT_AVAILABLE")n.requestTimeout(le,100);else throw $}}function ve(){var $=void 0;w&&z.push(t.getImageData(0,0,B,P)),k&&(t.font=fe,t.fillStyle=b,t.textAlign=G,t.textBaseline=U,t.fillText(k,Z,re)),$=t.getImageData(0,0,B,P),Y.addFrameImageData($),W=se,y((_-W)/_),se>0&&n.requestTimeout(oe,K),W||Y.getBase64GIF(function(g){a({error:!1,errorCode:"",errorMsg:"",image:g,cameraStream:o,videoElement:O,webcamVideoElement:j,savedRenderingContexts:z,keepCameraOn:f})})}};_=_!==T?_:10,R=R!==T?R:.1,i.width=B,i.height=P,t=i.getContext("2d"),function oe(){if(!C.length&&O.currentTime===0){n.requestTimeout(oe,100);return}ge()}()},getCropDimensions:function(){var e=arguments.length>0&&arguments[0]!==T?arguments[0]:{},a=e.videoWidth,i=e.videoHeight,t=e.gifWidth,l=e.gifHeight,s={width:0,height:0,scaledWidth:0,scaledHeight:0};return a>i?(s.width=Math.round(a*(l/i))-t,s.scaledWidth=Math.round(s.width*(i/l))):(s.height=Math.round(i*(t/a))-l,s.scaledHeight=Math.round(s.height*(a/t))),s}},D={loadedData:!1,defaultVideoDimensions:{width:640,height:480},findVideoSize:function r(e){r.attempts=r.attempts||0;var a=e.cameraStream,i=e.completedCallback,t=e.videoElement;t&&(t.videoWidth>0&&t.videoHeight>0?(t.removeEventListener("loadeddata",D.findVideoSize),i({videoElement:t,cameraStream:a,videoWidth:t.videoWidth,videoHeight:t.videoHeight})):r.attempts<10?(r.attempts+=1,n.requestTimeout(function(){D.findVideoSize(e)},400)):i({videoElement:t,cameraStream:a,videoWidth:D.defaultVideoDimensions.width,videoHeight:D.defaultVideoDimensions.height}))},onStreamingTimeout:function(e){n.isFunction(e)&&e({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - Timed out while trying to start streaming",image:null,cameraStream:{}})},stream:function(e){var a=n.isArray(e.existingVideo)?e.existingVideo[0]:e.existingVideo,i=e.cameraStream,t=e.completedCallback,l=e.streamedCallback,s=e.videoElement;if(n.isFunction(l)&&l(),a){if(n.isString(a))s.src=a,s.innerHTML='<source src="'+a+'" type="video/'+n.getExtension(a)+'" />';else if(a instanceof Blob){try{s.src=n.URL.createObjectURL(a)}catch{}s.innerHTML='<source src="'+a+'" type="'+a.type+'" />'}}else if(s.mozSrcObject)s.mozSrcObject=i;else if(n.URL)try{s.srcObject=i,s.src=n.URL.createObjectURL(i)}catch{s.srcObject=i}s.play(),n.requestTimeout(function o(){o.count=o.count||0,D.loadedData===!0?(D.findVideoSize({videoElement:s,cameraStream:i,completedCallback:t}),D.loadedData=!1):(o.count+=1,o.count>10?D.findVideoSize({videoElement:s,cameraStream:i,completedCallback:t}):o())},0)},startStreaming:function(e){var a=n.isFunction(e.error)?e.error:n.noop,i=n.isFunction(e.streamed)?e.streamed:n.noop,t=n.isFunction(e.completed)?e.completed:n.noop,l=e.crossOrigin,s=e.existingVideo,o=e.lastCameraStream,v=e.options,c=e.webcamVideoElement,b=n.isElement(s)?s:c||N.createElement("video");l&&(b.crossOrigin=v.crossOrigin),b.autoplay=!0,b.loop=!0,b.muted=!0,b.addEventListener("loadeddata",function(S){D.loadedData=!0,v.offset&&(b.currentTime=v.offset)}),s?D.stream({videoElement:b,existingVideo:s,completedCallback:t}):o?D.stream({videoElement:b,cameraStream:o,streamedCallback:i,completedCallback:t}):n.getUserMedia({video:!0},function(S){D.stream({videoElement:b,cameraStream:S,streamedCallback:i,completedCallback:t})},a)},startVideoStreaming:function(e){var a=arguments.length>1&&arguments[1]!==T?arguments[1]:{},i=a.timeout!==T?a.timeout:0,t=a.callback,l=a.webcamVideoElement,s=void 0;i>0&&(s=n.requestTimeout(function(){D.onStreamingTimeout(t)},1e4)),D.startStreaming({error:function(){t({error:!0,errorCode:"getUserMedia",errorMsg:"There was an issue with the getUserMedia API - the user probably denied permission",image:null,cameraStream:{}})},streamed:function(){clearTimeout(s)},completed:function(){var v=arguments.length>0&&arguments[0]!==T?arguments[0]:{},c=v.cameraStream,b=v.videoElement,S=v.videoHeight,p=v.videoWidth;e({cameraStream:c,videoElement:b,videoHeight:S,videoWidth:p})},lastCameraStream:a.lastCameraStream,webcamVideoElement:l,crossOrigin:a.crossOrigin,options:a})},stopVideoStreaming:function(e){e=n.isObject(e)?e:{};var a=e,i=a.keepCameraOn,t=a.videoElement,l=a.webcamVideoElement,s=e.cameraStream||{},o=s.getTracks?s.getTracks()||[]:[],v=!!o.length,c=o[0];!i&&v&&n.isFunction(c.stop)&&c.stop(),n.isElement(t)&&!l&&(t.pause(),n.isFunction(n.URL.revokeObjectURL)&&!n.webWorkerError&&t.src&&n.URL.revokeObjectURL(t.src),n.removeElement(t))}};function Ce(r){r=n.isObject(r)?r:{},D.stopVideoStreaming(r)}function Se(r,e){var a=r.options||{},i=a.images,t=a.video,l=Number(a.gifWidth),s=Number(a.gifHeight);Number(a.numFrames);var o=r.cameraStream,v=r.videoElement,c=r.videoWidth,b=r.videoHeight,S=me.getCropDimensions({videoWidth:c,videoHeight:b,gifHeight:s,gifWidth:l}),p=e;a.crop=S,a.videoElement=v,a.videoWidth=c,a.videoHeight=b,a.cameraStream=o,n.isElement(v)&&(v.width=l+S.width,v.height=s+S.height,a.webcamVideoElement||(n.setCSSAttr(v,{position:"fixed",opacity:"0"}),N.body.appendChild(v)),v.play(),me.getGIF(a,function(f){(!i||!i.length)&&(!t||!t.length)&&Ce(f),p(f)}))}function ze(){var r=arguments.length>0&&arguments[0]!==T?arguments[0]:{},e=r.callback,a=r.existingVideo,i=r.options,t={getUserMedia:!0,"window.URL":!0},l=X.validate(t),s=void 0,o=void 0;if(l.error)return e(l);if(n.isElement(a)&&a.src){if(o=a.src,s=n.getExtension(o),!n.isSupported.videoCodecs[s])return e(X.messages.videoCodecs)}else n.isArray(a)&&n.each(a,function(v,c){if(c instanceof Blob?s=c.type.substr(c.type.lastIndexOf("/")+1,c.length):s=c.substr(c.lastIndexOf(".")+1,c.length),n.isSupported.videoCodecs[s])return a=c,!1});D.startStreaming({completed:function(c){c.options=i||{},Se(c,e)},existingVideo:a,crossOrigin:i.crossOrigin,options:i})}function Le(){var r=arguments.length>0&&arguments[0]!==T?arguments[0]:{},e=r.callback,a=r.lastCameraStream,i=r.options,t=r.webcamVideoElement;if(!he())return e(X.validate());if(i.savedRenderingContexts.length){me.getGIF(i,function(l){e(l)});return}D.startVideoStreaming(function(){var l=arguments.length>0&&arguments[0]!==T?arguments[0]:{};l.options=i||{},Se(l,e)},{lastCameraStream:a,callback:e,webcamVideoElement:t,crossOrigin:i.crossOrigin})}function ye(r,e){if(e=n.isFunction(r)?r:e,r=n.isObject(r)?r:{},!!n.isFunction(e)){var a=n.mergeOptions(de,r)||{},i=r.cameraStream,t=a.images,l=t?t.length:0,s=a.video,o=a.webcamVideoElement;a=n.mergeOptions(a,{gifWidth:Math.floor(a.gifWidth),gifHeight:Math.floor(a.gifHeight)}),l?Ve({images:t,imagesLength:l,callback:e,options:a}):s?ze({existingVideo:s,callback:e,options:a}):Le({lastCameraStream:i,callback:e,webcamVideoElement:o,options:a})}}function He(r,e){if(e=n.isFunction(r)?r:e,r=n.isObject(r)?r:{},!!n.isFunction(e)){var a=n.mergeOptions(de,r),i=n.mergeOptions(a,{interval:.1,numFrames:1,gifWidth:Math.floor(a.gifWidth),gifHeight:Math.floor(a.gifHeight)});ye(i,e)}}var Ge={utils:We,error:Ee,defaultOptions:Ae,createGIF:ye,takeSnapShot:He,stopVideoStreaming:Ce,isSupported:Te,isWebCamGIFSupported:he,isExistingVideoGIFSupported:Ue,isExistingImagesGIFSupported:Ie,VERSION:"0.4.5"};ke.exports=Ge})(typeof window<"u"?window:{},typeof document<"u"?document:{createElement:function(){}},typeof window<"u"?window.navigator:{})})(Fe);var De=Fe.exports;const _e=Pe(De);export{_e as g};
